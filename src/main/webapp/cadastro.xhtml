<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:jsf="http://xmlns.jcp.org/jsf"
                xmlns:f="http://java.sun.com/jsf/core"
                template="WEB-INF/template.xhtml"
                xmlns:p="http://primefaces.org/ui">

    <ui:define name="content">
        <h:head>
            <title>Material Loin</title>
            <h:head>
                <title>Material Loin</title>
                <!-- Compiled and minified CSS -->
                <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.1/css/materialize.min.css"/>
                <h:outputStylesheet name="common.css" library="styles" />
                <!-- Compiled and minified JavaScript -->
                <h:outputScript library="primefaces" name="jquery/jquery.js" target="head" />
            </h:head>
        </h:head>
        <h:body styleClass="cyan-lighten-5">
            <h1>Faca o Seu cadastro</h1>
            <div class="valign-wrapper" >

                <div class="container">
                    <div class="center-align">
                        <div class="valign-wrapper " >

                            <div class="container">
                                <div class="col s6 offset-3 "  >
                                    <div class="card">
                                        <div class="card-content">
                                            <img class="responsive-img" style="max-width: 94px;" src="resources/images/no-excel.png" />
                                            <div class="left-align" >

                                                <h:form id="login-fom"  prependId="false" >

                                                    <div class="row">
                                                        <div class="input-field col s12">
                                                            <label for="client-email" class="active" style="font-size: 20px; color:black; font-family:Arial, Helvetica, sans-serif; padding-top: 5%; font-weight: bold;" >Selecione o seu vinculo com a UTFPR:</label>
                                                        </div>
                                                        <div  style="padding-top: 5%;" >
                                                            <h:panelGrid columns="2" columnClasses="cellGridFormLabel,none,cellGridFormLabel,none">

                                                                <p:selectOneRadio id="console"
                                                                                  value="#{examinationFormBean.radioVal}"
                                                                                  label="Action">
                                                                    <f:selectItem   itemLabel="Aluno ou Professor" itemValue="student" id="student"  />

                                                                    <f:selectItem itemLabel="Visitante" id="visitor"
                                                                                  itemValue="visitor" />
                                                                    <p:ajax process="console"
                                                                            update="@form" />
                                                                </p:selectOneRadio>
                                                            </h:panelGrid>

                                                        </div>
                                                        <div class="input-field col s11" id="combo">
                                                            <p:inputText id="compid"  label="cpf"  size="40" class="default-input" required="true" onfocus="$(this).attr('placeholder', '');" onblur="$(this).attr('placeholder', 'CPF');"
                                                                         requiredMessage="Campo CPF e obrigatorio" title="Informe o CPF, somente numeros"
                                                                         validatorMessage="Campo CPF e obrigatorio"
                                                                         value="#{userBean.user.login}"
                                                                         rendered="#{examinationFormBean.radioVal eq 'visitor'}"/>
                                                            <p:tooltip id="tool1" for="compid" showEvent="focus" hideEvent="blur" />
                                                            <p:watermark for="compid" value="CPF" />


                                                            <p:inputText id="studentid" label="ra" size="40" class="default-input" required="true" onfocus="$(this).attr('placeholder', '');"
                                                                         requiredMessage="Campo RA e obrigatorio" title="Informe o seu RA, somente digitos" onblur="$(this).attr('placeholder', 'RA');"

                                                                         value="#{userBean.user.login}"
                                                                         rendered="#{examinationFormBean.radioVal eq 'student'}"/>
                                                            <p:tooltip id="tool2" for="studentid" showEvent="focus" hideEvent="blur" />
                                                            <p:watermark for="studentid" value="RA " />
                                                            <!--<p:messages for="studentid"  closable="true" autoUpdate="true" /> -->
                                                        </div>
                                                        <dv class="s1">
                                                            <img class="responsive-img" id="error-id" style="max-width: 35px; padding-top: 20px; padding-left: 10px; display: none" src="resources/images/error.png" />
                                                        </dv>
                                                        <div class="col s1">
                                                            <img class="responsive-img" id="ok-id" style="max-width: 24px; padding-top: 20px; display: none" src="resources/images/ok.jpg" />
                                                        </div>
                                                        <div class="col s11 input-field okname" >
                                                            <h:inputText id="name"  class="default-input" value="#{userBean.user.name}" title="Informe seu nome completo"  onfocus="$(this).attr('placeholder', '');" onblur="$(this).attr('placeholder', 'Nome');"  required="true"  requiredMessage="Campo nome e obrigatorio " />
                                                            <p:tooltip id="tool3" for="name" showEvent="focus" hideEvent="blur"  />
                                                            <p:watermark for="name" value="Nome"   />


                                                        </div>
                                                        <div class="col s1">
                                                            <img class="responsive-img" id="error-name" style="max-width: 24px; padding-top: 20px; display: none" src="resources/images/error.png" />
                                                        </div>
                                                        <div class="col s1">
                                                            <img class="responsive-img" id="ok-name" style="max-width: 24px; padding-top: 20px; display: none" src="resources/images/ok.jpg" />
                                                        </div>
                                                        <div class="col s11 input-field">
                                                            <h:inputText id="email" class="default-input"  title="Informe seu email"   value="#{userBean.user.email}" required="true"  onfocus="$(this).attr('placeholder', '');" onblur="$(this).attr('placeholder', 'Email');"  requiredMessage="Campo email e obrigatorio"/>
                                                            <p:tooltip id="tool4" for="email" showEvent="focus" hideEvent="blur"  />
                                                            <p:watermark for="email"  value="Email"  />

                                                        </div>
                                                        <div class="col s1">
                                                            <img class="responsive-img" id="error-email"  style="max-width: 24px; padding-top: 20px;  display: none;x" src="resources/images/error.png" />
                                                        </div>
                                                        <div class="col s1">
                                                            <img class="responsive-img" id="ok-email" style="max-width: 24px; padding-top: 20px; display: none" src="resources/images/ok.jpg" />
                                                        </div>
                                                        <div class="col s11 input-field">
                                                            <p:password id="pass" required="true"  class="default-input" title="Informe sua senha, deve conter ao menos um numero e uma letra"  placeholder="Senha" value="#{userBean.user.password}"  requiredMessage="Campo  senha e obrigatorio" onfocus="$(this).attr('placeholder', '');" onblur="$(this).attr('placeholder', 'Senha');"  />
                                                            <p:tooltip id="tool5" for="pass" showEvent="focus" hideEvent="blur"  />

                                                        </div>
                                                        <div class="col s1">
                                                            <img class="responsive-img" id="error-pass" style="max-width: 24px; padding-top: 20px;  display: none;" src="resources/images/error.png" />
                                                        </div>
                                                        <div class="col s1">
                                                            <img class="responsive-img" id="ok-pass" style="max-width: 24px; padding-top: 20px; display: none" src="resources/images/ok.jpg" />
                                                        </div>
                                                        <div class="col s11 input-field">
                                                            <p:password  id="repass" required="true" class="default-input" title="Repita a senha"  placeholder="Repita a Senha" value="#{beanValidationView.passVerify}"   requiredMessage="Campo repitir senha e obrigatorio" onfocus="$(this).attr('placeholder', '');" onblur="$(this).attr('placeholder', 'Repita a Senha');"  />
                                                            <p:tooltip id="tool6" for="repass" showEvent="focus" hideEvent="blur"  />

                                                        </div>
                                                        <div class="col s1">
                                                            <img class="responsive-img" id="error-repass" style="max-width: 24px; padding-top: 20px; display: none;" src="resources/images/error.png" />
                                                        </div>
                                                        <div class="col s1">
                                                            <img class="responsive-img" id="ok-repass" style="max-width: 24px; padding-top: 20px; display: none" src="resources/images/ok.jpg" />
                                                        </div>
                                                        <div class="col s12 input-field ">
                                                            <p:commandButton action="#{userBean.persist()}" onclick="return validateAll(this.form);"  id="enviar" value="submit" type="submit" ajax="true" validateClient="true" update="@form"   ></p:commandButton>
                                                        </div>
                                                        <!--
                                                        <button  disabled="true"    id="enviar" value="submit"  ajax="true" validateClient="true"  class="btn waves-effect waves-light" type="submit" name="action">Cadastrar
                                                            <i class="material-icons right ">send</i>
                                                        </button> -->


                                                        <div class="col s12 input-field wrong-grownl">
                                                            <p:growl widgetVar="growlWV" life="1000" />
                                                            <p:growl widgetVar="email-error" life="1000" />
                                                            <p:growl widgetVar="ra-error" life="1000" />
                                                            <p:growl widgetVar="ratio-error" life="1000" />
                                                            <p:growl widgetVar="ratio-error-visitor" life="1000"/>
                                                            <p:growl widgetVar="ratio-error-student" life="1000" />
                                                            <p:growl widgetVar="cpf-error"  life="1000"/>
                                                            <p:growl widgetVar="cpf-error-missing" life="1000" />
                                                            <p:growl widgetVar="name-error" life="1000" />
                                                            <p:growl widgetVar="email-error" life="1000" />
                                                            <p:growl widgetVar="pass-error" life="1000"  />
                                                            <p:growl widgetVar="raerror" life="1000"  />
                                                            <p style="color:red; font-size: 12px">Todos os campos sao obrigatorios, senha deve conter ao menos uma letra e um numero</p>
                                                            <p style="color:red; font-size: 12px">Atencao seu RA ou CPF serao usados para acesso ao sistema</p>
                                                        </div>
                                                    </div>

                                                    <script>


                                                        function validateAll(form) {
                                                            var ra = $('#studentid').val();
                                                            var cpf = $('#compid').val();
                                                            var email = $('#email').val();
                                                            var pass = $('#pass').val();
                                                            var repass = $('#repass').val();
                                                            var name = $('#name').val();
                                                            var valid = true;
                                                            var opt = $('input[name="console"]:checked').val();

                                                            if (opt == "student") {
                                                                if (ra == "" || ra == null || !isRa(ra)) {
                                                                    $('input[id="studentid"]').addClass('error');
                                                                    PF('ra-error').renderMessage({"summary": "Informe seu ra",
                                                                        "severity": "error"});
                                                                    $("#error-id").show();
                                                                    $("#ok-id").hide();
                                                                    valid = false;
                                                                } else {
                                                                    $('input[id="studentid"]').removeClass('error');
                                                                    $("#error-id").hide();
                                                                    $("#ok-id").show();
                                                                }
                                                            } else if (opt == "visitor") {
                                                                if (cpf == "" || cpf == null || !isCpf(cpf)) {
                                                                    $('input[id="compid"]').addClass('error');
                                                                    $("#error-id").show();
                                                                    $("#ok-id").hide();
                                                                    valid = false;
                                                                } else {
                                                                    $('input[id="compid"]').removeClass('error');
                                                                    $("#error-id").hide();
                                                                    $("#ok-id").show();
                                                                }
                                                            }
                                                            if (email == "" || email == null || !isEmail(email)) {
                                                                $('input[id="email"]').addClass('error');
                                                                $("#error-email").show();
                                                                $("#ok-email").hide();
                                                                valid = false;
                                                            } else {
                                                                $('input[id="email"]').removeClass('error');
                                                                $("#error-email").hide();
                                                                $("#ok-email").show();
                                                            }
                                                            if (pass == "" || pass == null || !isPass(pass)) {
                                                                $('input[id="pass"]').addClass('error');
                                                                $("#error-pass").show();
                                                                $("#ok-pass").hide();
                                                                valid = false;
                                                            } else {
                                                                $('input[id="pass"]').removeClass('error');
                                                                $("#error-pass").hide();
                                                                $("#ok-pass").show();
                                                            }

                                                            if (repass == "" || repass == null || !validaterePass()) {
                                                                $('input[id="repass"]').addClass('error');
                                                                $("#error-repass").show();
                                                                $("#ok-repass").hide();
                                                                valid = false;
                                                            } else {
                                                                $('input[id="repass"]').removeClass('error');
                                                                $("#error-repass").hide();
                                                                $("#ok-repass").show();
                                                            }

                                                            if (name == "" || name == null || !isName(name)) {
                                                                $('input[id="name"]').addClass('error');
                                                                $("#error-name").show();
                                                                $("#ok-name").hide();
                                                                valid = false;
                                                            } else {
                                                                $('input[id="name"]').removeClass('error');
                                                                $("#error-name").hide();
                                                                $("#ok-name").show();
                                                            }
                                                            return valid;
                                                        }



                                                        $("#repass").focus(function () {
                                                            if (isPass($('#pass').val())) {
                                                                $('input[id="pass"]').removeClass('error');
                                                                $('input[id="pass"]').addClass('default-input');
                                                            } else
                                                                $('input[id="pass"]').addClass('error');
                                                        });
                                                        function isName(name) {
                                                            var regex = /^[A-Z][a-z]+([ ][A-Z][a-z]+)*$/;
                                                            return regex.test(name);
                                                        }
                                                        function isRa(ra) {
                                                            var regex = /^\d{8,8}$/;
                                                            return regex.test(ra);
                                                        }
                                                        function isCpf(cpf) {
                                                            var regex = /([0-9]{2}[\.]?[0-9]{3}[\.]?[0-9]{3}[\/]?[0-9]{4}[-]?[0-9]{2})|([0-9]{3}[\.]?[0-9]{3}[\.]?[0-9]{3}[-]?[0-9]{2})/;
                                                            return regex.test(cpf);
                                                        }
                                                        $("login-form").submit(function (e) {
                                                            if (isPass($('#pass').val()))
                                                                alert("OKKK");
                                                            else
                                                                e.preventDefault();
                                                        });
                                                        $("#enviar").mouseover(function go() {
                                                            validateAll();
                                                            var isChecked = jQuery("input[name=console]:checked").val();
                                                            var booleanVlaueIsChecked = false;
                                                            var cpf = $('#compid').val();
                                                            var ra = $('#studentid').val();
                                                            var opt = $('input[name="console"]:checked').val();
                                                            if (!isChecked) {
                                                                booleanVlaueIsChecked = true;
                                                                PF('ratio-error').renderMessage({"summary": "Selecione seu vinculo com a faculdade",
                                                                    "severity": "error"});
                                                            }
                                                            if (opt == "student") {

                                                                if (ra == "") {
                                                                    PF('cpf-error').renderMessage({"summary": "Informe o RA",
                                                                        "severity": "error"});
                                                                    $('input[id="studentid"]').addClass('error');
                                                                } else if (!isRa(ra)) {
                                                                    $('input[id="studentid"]').addClass('error');
                                                                } else {

                                                                    validateForm();
                                                                }
                                                            } else if (opt == "visitor") {
                                                                if (cpf == "") {
                                                                    PF('cpf-error-missing').renderMessage({"summary": "Informe o cpf",
                                                                        "severity": "error"});
                                                                    $('input[id="compid"]').addClass('error');
                                                                } else if ((!isCpf(cpf))) {
                                                                    PF('cpf-error').renderMessage({"summary": "CPF incorreto, apenas numeros, por exemplo: 12345678912",
                                                                        "severity": "error"});
                                                                    $('input[id="compid"]').addClass('error');
                                                                } else {
                                                                    validateForm();
                                                                }
                                                            }


                                                        });
                                                        function validaterePass() {
                                                            var pass = $('#pass').val();
                                                            var repass = $('#repass').val();
                                                            if (pass == repass) {
                                                                return true;
                                                            } else {
                                                                PF('pass-error').renderMessage({"summary": "As senhas nao conferem",
                                                                    "severity": "error"});
                                                                return false;
                                                            }
                                                        }
                                                        function validatePass() {
                                                            var pass = $('#pass').val();
                                                            if (isPass(pass)) {
                                                                validaterePass();
                                                            } else
                                                                PF('pass-error').renderMessage({"summary": "Snha incorreta, deve conter pelo menos um numero e uma letra, no minimo 6 digitos",
                                                                    "severity": "error"});
                                                            $('input[id="compid"]').addClass('error');
                                                        }
                                                        function validateForm() {
                                                            var name = $('#name').val();
                                                            var email = $('#email').val();
                                                            if ($('#name').val() == "") {

                                                                PF('name-error').renderMessage({"summary": "Informe seu nome respeitando caracters maisculos e minusculos",
                                                                    "severity": "error"});
                                                                // $('input[id="name"]').addClass('error');

                                                            } else if (!isName(name)) {

                                                                PF('name-error').renderMessage({"summary": "Nome nao aceito",
                                                                    "severity": "error"});
                                                            } else if ($('#email').val() == "") {
                                                                PF('email-error').renderMessage({"summary": "Informe seu email",
                                                                    "severity": "error"});
                                                                $('input[id="email"]').addClass('error');
                                                            } else if (!isEmail($('#email').val())) {

                                                                PF('email-error').renderMessage({"summary": "Email incorreto, por exemplo: joao@domain.com",
                                                                    "severity": "error"});
                                                                $('input[id="email"]').addClass('error');
                                                            } else
                                                                validatePass();
                                                        }


                                                        function isEmail(email) {
                                                            var regex = /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;
                                                            return regex.test(email);
                                                        }
                                                        function isPass(pass) {
                                                            var regex = /^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,}$/;
                                                            return regex.test(pass);
                                                        }

                                                        $("input[id=studentid]").bind('input propertychange', function () {

                                                            var ra = $('#studentid').val();
                                                            if (ra == "" || ra == null || !isRa(ra)) {
                                                                $('input[id="studentid"]').addClass('error');
                                                                PF('ra-error').renderMessage({"summary": "Informe seu ra",
                                                                    "severity": "error"});
                                                                $("#error-id").show();
                                                                $("#ok-id").hide();
                                                            } else {
                                                                $('input[id="studentid"]').removeClass('error');
                                                                $("#error-id").hide();
                                                                $("#ok-id").show();
                                                            }
                                                        });
                                                        $("input[id=compid]").bind('input propertychange', function () {

                                                            var cpf = $('#compid').val();
                                                            if (cpf == "" || cpf == null || !isCpf(cpf)) {
                                                                $('input[id="compid"]').addClass('error');
                                                                $("#error-id").show();
                                                                $("#ok-id").hide();
                                                            } else {
                                                                $('input[id="compid"]').removeClass('error');
                                                                $("#error-id").hide();
                                                                $("#ok-id").show();
                                                            }
                                                        });
                                                        $("input[id=email]").bind('input propertychange', function () {

                                                            var email = $('#email').val();
                                                            if (email == "" || email == null || !isEmail(email)) {
                                                                $('input[id="email"]').addClass('error');
                                                                $("#error-email").show();
                                                                $("#ok-email").hide();
                                                            } else {
                                                                $('input[id="email"]').removeClass('error');
                                                                $("#error-email").hide();
                                                                $("#ok-email").show();
                                                            }
                                                        });
                                                        $("input[id=pass]").bind('input propertychange', function () {

                                                            var pass = $('#pass').val();
                                                            if (pass == "" || pass == null || !isPass(pass)) {
                                                                $('input[id="pass"]').addClass('error');
                                                                $("#error-pass").show();
                                                                $("#ok-pass").hide();
                                                            } else {
                                                                $('input[id="pass"]').removeClass('error');
                                                                $("#error-pass").hide();
                                                                $("#ok-pass").show();
                                                            }
                                                        });
                                                        $("input[id=repass]").bind('input propertychange', function () {

                                                            var repass = $('#repass').val();
                                                            if (repass == "" || repass == null || !validaterePass()) {
                                                                $('input[id="repass"]').addClass('error');
                                                                $("#error-repass").show();
                                                                $("#ok-repass").hide();
                                                            } else {
                                                                $('input[id="repass"]').removeClass('error');
                                                                $("#error-repass").hide();
                                                                $("#ok-repass").show();
                                                            }
                                                        });
                                                        $("input[id=name]").bind('input propertychange', function () {

                                                            var errName = $("#okname"); //Element selector
                                                            errName.html("Please enter name"); // Put the message content inside div
                                                            errName.addClass('error-msg'); //add a class to the element
                                                            var name = $('#name').val();
                                                            if (name == "" || name == null || !isName(name)) {
                                                                $('input[id="name"]').addClass('error');
                                                                $("#error-name").show();
                                                                $("#ok-name").hide();
                                                            } else {
                                                                $('input[id="name"]').removeClass('error');
                                                                $("#error-name").hide();
                                                                $("#ok-name").show();
                                                            }
                                                        });
                                                    </script>
                                                </h:form>


                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </h:body>
        <!-- intro -->
    </ui:define>

</ui:composition>